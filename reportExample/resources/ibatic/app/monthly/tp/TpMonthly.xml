<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="tpMonthly">
 
<select id="getFawTp" resultClass="com.ways.app.monthly.tp.model.FawTp">
<!-- 分页获取信息 -->
		select t.* from (
			select a.*, rownum as rowIndex
			from (
				select tab.*, count(1) over() totalCount from (
					Select year,month,price,version_code versioncode From fdm_faw_version_price
				)tab where 1=1
					<isNotEmpty property="qYear" prepend="and">
						upper(tab.year) like upper('%$qYear$%')
			       </isNotEmpty>
			       <isNotEmpty property="qMonth" prepend="and">
			       		upper(tab.month) like upper('%$qMonth$%')
			       </isNotEmpty>
			       <isNotEmpty property="qPrice" prepend="and">
			       		upper(tab.price) like upper('%$qPrice$%')
			       </isNotEmpty>
			       <isNotEmpty property="qVersioncode" prepend="and">
			       		upper(tab.versioncode) like upper('%$qVersioncode$%')
			       </isNotEmpty>
					<isNotEmpty property="order">
						$order$ 
					</isNotEmpty>
					<isEmpty property="order">
						order by tab.versioncode desc
					</isEmpty>
			) a
		) t
		where 1=1
		<isNotEmpty property="start" prepend="and">
			t.rowIndex > $start$  and t.rowIndex <![CDATA[ <=  ]]> $limit$
		</isNotEmpty>
	</select>

</sqlMap>